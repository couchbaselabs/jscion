<html>
<head>
  <title>jscion</title>
  <link href="bootstrap/css/bootstrap.min.css" rel="stylesheet" media="screen">
  <link href="jscion.css" rel="stylesheet" media="screen">
</head>
<body>
<div id="container"></div>
<script src="js/underscore-1.5.2.min.js"></script>
<script src="js/jquery-1.10.2.min.js"></script>
<script src="js/jscion.js"></script>
<script>
var g_ctx;

$(function() {
  $.ajax({ url: "/data.json",
           dataType: "json",
           success: function(data) { g_ctx = jsion(data); redraw(); }
         });
});

$(window).bind('hashchange', redraw);

function redraw() {
  // A target looks like "ident,key0=val0,key1=val1".
  var target = window.location.hash ? window.location.hash.substring(1) : "uiPanel-start";
  var ident = target.split(",")[0];
  var opts = _.reduce(_.tail(target.split(",")), function(o, kv) {
    o[kv.split('=')[0]] = kv.split('=')[1];
    return o;
  }, {})
  var r = g_ctx.renderIdent(ident || "uiPanel-start", opts);
  var h = r.err || r.result || "no render result";
  $("#container").html(h);
}
</script>
<script src="bootstrap/js/bootstrap.min.js"></script>
</body>
</html>
